\doxysection{sha3.\+h}
\hypertarget{sha3_8h_source}{}\label{sha3_8h_source}\mbox{\hyperlink{sha3_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#ifndef\ SHA3\_H}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#define\ SHA3\_H}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <stdint.h>}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{comment}{/*\ 'Words'\ here\ refers\ to\ uint64\_t\ */}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ SHA3\_KECCAK\_SPONGE\_WORDS\ \(\backslash\)}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\ \ \ \ (((1600)\ /\ 8\ }\textcolor{comment}{/*bits\ to\ byte*/}\textcolor{preprocessor}{)\ /\ sizeof(uint64\_t))}}
\DoxyCodeLine{00034\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsha3__context__}{sha3\_context\_}}}
\DoxyCodeLine{00035\ \{}
\DoxyCodeLine{00036\ \ \ \ \ uint64\_t\ saved;\ \textcolor{comment}{/*\ the\ portion\ of\ the\ input\ message\ that\ we}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ didn't\ consume\ yet\ */}}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keyword}{union}}
\DoxyCodeLine{00039\ \ \ \ \ \{\ \textcolor{comment}{/*\ Keccak's\ state\ */}}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ uint64\_t\ s[\mbox{\hyperlink{sha3_8h_a523878099e5ec16cb61e01d0365201f5}{SHA3\_KECCAK\_SPONGE\_WORDS}}];}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ uint8\_t\ sb[\mbox{\hyperlink{sha3_8h_a523878099e5ec16cb61e01d0365201f5}{SHA3\_KECCAK\_SPONGE\_WORDS}}\ *\ 8];}
\DoxyCodeLine{00042\ \ \ \ \ \}\ u;}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ byteIndex;\ \ \ \ \ \textcolor{comment}{/*\ 0..7-\/-\/the\ next\ byte\ after\ the\ set\ one}}
\DoxyCodeLine{00044\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ (starts\ from\ 0;\ 0-\/-\/none\ are\ buffered)\ */}}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ wordIndex;\ \ \ \ \ \textcolor{comment}{/*\ 0..24-\/-\/the\ next\ word\ to\ integrate\ input}}
\DoxyCodeLine{00046\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ (starts\ from\ 0)\ */}}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ capacityWords;\ \textcolor{comment}{/*\ the\ double\ size\ of\ the\ hash\ output\ in}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ words\ (e.g.\ 16\ for\ Keccak\ 512)\ */}}
\DoxyCodeLine{00049\ \}\ \mbox{\hyperlink{structsha3__context__}{sha3\_context}};}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{keyword}{enum}\ SHA3\_FLAGS}
\DoxyCodeLine{00052\ \{}
\DoxyCodeLine{00053\ \ \ \ \ SHA3\_FLAGS\_NONE\ =\ 0,}
\DoxyCodeLine{00054\ \ \ \ \ SHA3\_FLAGS\_KECCAK\ =\ 1}
\DoxyCodeLine{00055\ \};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{keyword}{enum}\ SHA3\_RETURN}
\DoxyCodeLine{00058\ \{}
\DoxyCodeLine{00059\ \ \ \ \ SHA3\_RETURN\_OK\ =\ 0,}
\DoxyCodeLine{00060\ \ \ \ \ SHA3\_RETURN\_BAD\_PARAMS\ =\ 1}
\DoxyCodeLine{00061\ \};}
\DoxyCodeLine{00062\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ SHA3\_RETURN\ sha3\_return\_t;}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \textcolor{comment}{/*\ For\ Init\ or\ Reset\ call\ these:\ */}}
\DoxyCodeLine{00065\ sha3\_return\_t\ sha3\_Init(\textcolor{keywordtype}{void}\ *priv,\ \textcolor{keywordtype}{unsigned}\ bitSize);}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{keywordtype}{void}\ sha3\_Init256(\textcolor{keywordtype}{void}\ *priv);}
\DoxyCodeLine{00068\ \textcolor{keywordtype}{void}\ sha3\_Init384(\textcolor{keywordtype}{void}\ *priv);}
\DoxyCodeLine{00069\ \textcolor{keywordtype}{void}\ sha3\_Init512(\textcolor{keywordtype}{void}\ *priv);}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{keyword}{enum}\ SHA3\_FLAGS\ sha3\_SetFlags(\textcolor{keywordtype}{void}\ *priv,\ \textcolor{keyword}{enum}\ SHA3\_FLAGS);}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{keywordtype}{void}\ sha3\_Update(\textcolor{keywordtype}{void}\ *priv,\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{const}\ *bufIn,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{const}\ *sha3\_Finalize(\textcolor{keywordtype}{void}\ *priv);}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \textcolor{comment}{/*\ Single-\/call\ hashing\ */}}
\DoxyCodeLine{00078\ sha3\_return\_t\ sha3\_HashBuffer(}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ bitSize,\ \ \ \ \ \ \textcolor{comment}{/*\ 256,\ 384,\ 512\ */}}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keyword}{enum}\ SHA3\_FLAGS\ flags,\ \textcolor{comment}{/*\ SHA3\_FLAGS\_NONE\ or\ SHA3\_FLAGS\_KECCAK\ */}}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *in,\ \textcolor{keywordtype}{unsigned}\ inBytes,\ \textcolor{keywordtype}{void}\ *out,}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ outBytes);\ \textcolor{comment}{/*\ up\ to\ bitSize/8;\ truncation\ OK\ */}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
